// Zodiac data
const zodiacData = {
  "ç‰¡ç¾Šåº§": {
    "dateRange": "3/21-4/19",
    "icon": "â™ˆ",
    "today": {
      "fortune": "ä»Šæ—¥ã¯ã‚¨ãƒãƒ«ã‚®ãƒƒã‚·ãƒ¥ãªä¸€æ—¥ã«ãªã‚Šãã†ã§ã™ã€‚æ–°ã—ã„ã“ã¨ã«æŒ‘æˆ¦ã™ã‚‹ã«ã¯çµ¶å¥½ã®æ—¥ã€‚ç©æ¥µæ€§ãŒå¹¸é‹ã‚’å‘¼ã³è¾¼ã¿ã¾ã™ã€‚",
      "love": "ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã¨ã®é–¢ä¿‚ãŒæ·±ã¾ã‚‹æš—ç¤ºã€‚ã‚·ãƒ³ã‚°ãƒ«ã®æ–¹ã¯æ„å¤–ãªå‡ºä¼šã„ãŒæœŸå¾…ã§ããã†ã€‚",
      "work": "ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã‚’ç™ºæ®ã§ãã‚‹æ—¥ã€‚ãƒãƒ¼ãƒ ã‚’ã¾ã¨ã‚ã‚‹åŠ›ãŒè©•ä¾¡ã•ã‚Œã‚‹ã§ã—ã‚‡ã†ã€‚",
      "money": "æŠ•è³‡ã‚„æ–°ã—ã„åŽå…¥æºã«ã¤ã„ã¦è€ƒãˆã‚‹è‰¯ã„æ©Ÿä¼šã€‚æ…Žé‡ã«æ¤œè¨Žã‚’ã€‚",
      "luckyColor": "èµ¤",
      "luckyNumber": 7
    }
  },
  "ç‰¡ç‰›åº§": {
    "dateRange": "4/20-5/20", 
    "icon": "â™‰",
    "today": {
      "fortune": "å®‰å®šã‚’æ±‚ã‚ã‚‹æ°—æŒã¡ãŒå¼·ããªã‚‹æ—¥ã€‚ç„¦ã‚‰ãšã˜ã£ãã‚Šã¨ç‰©äº‹ã‚’é€²ã‚ã‚‹ã“ã¨ãŒæˆåŠŸã¸ã®éµã§ã™ã€‚",
      "love": "ç©ã‚„ã‹ãªæ„›æƒ…ã«åŒ…ã¾ã‚Œã‚‹æ—¥ã€‚ç›¸æ‰‹ã®æ°—æŒã¡ã‚’å¤§åˆ‡ã«ã™ã‚‹å§¿å‹¢ãŒå‰ã€‚",
      "work": "ç²˜ã‚Šå¼·ã•ãŒåŠŸã‚’å¥ã—ã¾ã™ã€‚ç¶™ç¶šã—ã¦ããŸåŠªåŠ›ãŒå®Ÿã‚’çµã¶å…†ã—ã€‚",
      "money": "å …å®Ÿãªé‡‘éŠ­ç®¡ç†ãŒå¹¸é‹ã‚’ã‚‚ãŸã‚‰ã—ã¾ã™ã€‚ç„¡é§„é£ã„ã¯æŽ§ãˆã‚ã«ã€‚",
      "luckyColor": "ç·‘",
      "luckyNumber": 2
    }
  },
  "åŒå­åº§": {
    "dateRange": "5/21-6/21",
    "icon": "â™Š", 
    "today": {
      "fortune": "ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³èƒ½åŠ›ãŒå…‰ã‚‹æ—¥ã€‚å¤šãã®äººã¨ã®äº¤æµãŒæ–°ã—ã„å¯èƒ½æ€§ã‚’é–‹ãã¾ã™ã€‚",
      "love": "ä¼šè©±ã‚’é€šã˜ã¦ç›¸æ‰‹ã¨ã®è·é›¢ãŒç¸®ã¾ã‚‹æš—ç¤ºã€‚ç´ ç›´ãªæ°—æŒã¡ã‚’ä¼ãˆã¦ã€‚",
      "work": "æƒ…å ±åŽé›†ã¨äººè„ˆä½œã‚Šã«æœ€é©ãªæ—¥ã€‚æ–°ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ãŒæµ®ã‹ã³ãã†ã€‚",
      "money": "è¤‡æ•°ã®åŽå…¥æºã‚’æ¤œè¨Žã™ã‚‹ã®ã«è‰¯ã„æ—¥ã€‚åˆ†æ•£æŠ•è³‡ãŒã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã€‚",
      "luckyColor": "é»„è‰²",
      "luckyNumber": 3
    }
  },
  "èŸ¹åº§": {
    "dateRange": "6/22-7/22",
    "icon": "â™‹",
    "today": {
      "fortune": "å®¶æ—ã‚„èº«è¿‘ãªäººã¨ã®çµ†ãŒæ·±ã¾ã‚‹æ—¥ã€‚æ„Ÿæƒ…ã‚’å¤§åˆ‡ã«ã™ã‚‹ã“ã¨ã§è‰¯ã„çµæžœãŒã€‚",
      "love": "å¿ƒã®ç¹‹ãŒã‚Šã‚’é‡è¦–ã—ãŸé–¢ä¿‚ä½œã‚ŠãŒå‰ã€‚å„ªã—ã•ãŒç›¸æ‰‹ã«ä¼ã‚ã‚Šã¾ã™ã€‚",
      "work": "ãƒãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’æ´»ã‹ã—ãŸå–ã‚Šçµ„ã¿ãŒæˆåŠŸã‚’ã‚‚ãŸã‚‰ã—ã¾ã™ã€‚",
      "money": "å®¶è¨ˆã‚„å°†æ¥ã®å‚™ãˆã«ã¤ã„ã¦è€ƒãˆã‚‹è‰¯ã„ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã€‚",
      "luckyColor": "éŠ€",
      "luckyNumber": 4
    }
  },
  "ç…å­åº§": {
    "dateRange": "7/23-8/22",
    "icon": "â™Œ",
    "today": {
      "fortune": "è‡ªåˆ†ã‚‰ã—ã•ã‚’è¡¨ç¾ã™ã‚‹ã“ã¨ã§æ³¨ç›®ã‚’é›†ã‚ã‚‹æ—¥ã€‚è‡ªä¿¡ã‚’æŒã£ã¦è¡Œå‹•ã‚’ã€‚",
      "love": "ãƒ‰ãƒ©ãƒžãƒãƒƒã‚¯ãªå±•é–‹ãŒæœŸå¾…ã§ãã‚‹æ—¥ã€‚ç©æ¥µçš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒãŒå‰ã€‚",
      "work": "å‰µé€ æ€§ã¨è¡¨ç¾åŠ›ãŒè©•ä¾¡ã•ã‚Œã‚‹å ´é¢ãŒã€‚ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã«æœ€é©ã€‚",
      "money": "å¤§èƒ†ãªæŠ•è³‡ã‚ˆã‚Šã‚‚ã€ç¢ºå®Ÿæ€§ã‚’é‡è¦–ã—ãŸæ–¹ãŒè‰¯ã„çµæžœã«ã€‚",
      "luckyColor": "é‡‘",
      "luckyNumber": 5
    }
  },
  "ä¹™å¥³åº§": {
    "dateRange": "8/23-9/22",
    "icon": "â™",
    "today": {
      "fortune": "ç´°ã‹ãªé…æ…®ã¨ä¸å¯§ãªä½œæ¥­ãŒè©•ä¾¡ã•ã‚Œã‚‹æ—¥ã€‚å®Œç’§ä¸»ç¾©ãŒåŠŸã‚’å¥ã—ã¾ã™ã€‚",
      "love": "ç›¸æ‰‹ã¸ã®æ€ã„ã‚„ã‚ŠãŒé–¢ä¿‚ã‚’æ·±ã‚ã¾ã™ã€‚å°ã•ãªæ°—é£ã„ãŒå¤§åˆ‡ã€‚",
      "work": "åˆ†æžåŠ›ã¨çµ„ç¹”åŠ›ã‚’æ´»ã‹ã—ã¦æˆæžœã‚’ä¸Šã’ã‚‰ã‚Œã‚‹æ—¥ã€‚å“è³ªé‡è¦–ã§ã€‚",
      "money": "å®¶è¨ˆç°¿ã®è¦‹ç›´ã—ã‚„ç¯€ç´„ãƒ—ãƒ©ãƒ³ã®æ¤œè¨Žã«æœ€é©ãªæ—¥ã€‚",
      "luckyColor": "ç´º",
      "luckyNumber": 6
    }
  },
  "å¤©ç§¤åº§": {
    "dateRange": "9/23-10/23",
    "icon": "â™Ž",
    "today": {
      "fortune": "ãƒãƒ©ãƒ³ã‚¹æ„Ÿè¦šãŒå†´ãˆã‚‹æ—¥ã€‚å¯¾ç«‹ã™ã‚‹æ„è¦‹ã®èª¿å’Œã‚’å›³ã‚Œãã†ã€‚",
      "love": "ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚·ãƒƒãƒ—ãŒé‡è¦ãªãƒ†ãƒ¼ãƒžã€‚ç›¸æ‰‹ã¨ã®å¹³ç­‰ãªé–¢ä¿‚ã‚’å¿ƒãŒã‘ã¦ã€‚",
      "work": "äº¤æ¸‰ã‚„ä»²è£å½¹ã¨ã—ã¦åŠ›ã‚’ç™ºæ®ã§ãã‚‹æ—¥ã€‚å…¬å¹³æ€§ãŒéµã€‚",
      "money": "åŽæ”¯ã®ãƒãƒ©ãƒ³ã‚¹ã‚’è¦‹ç›´ã™ã®ã«è‰¯ã„ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã€‚",
      "luckyColor": "ãƒ”ãƒ³ã‚¯",
      "luckyNumber": 6
    }
  },
  "è åº§": {
    "dateRange": "10/24-11/22",
    "icon": "â™",
    "today": {
      "fortune": "ç›´æ„ŸåŠ›ãŒå†´ãˆã‚‹æ—¥ã€‚æ·±ãç‰©äº‹ã‚’è¦‹ã¤ã‚ã‚‹ã“ã¨ã§çœŸå®ŸãŒè¦‹ãˆã¦ããã†ã€‚",
      "love": "æƒ…ç†±çš„ãªæ„Ÿæƒ…ãŒé«˜ã¾ã‚‹æ—¥ã€‚æ·±ã„æ„›æƒ…ã‚’è¡¨ç¾ã™ã‚‹ãƒãƒ£ãƒ³ã‚¹ã€‚",
      "work": "é›†ä¸­åŠ›ã‚’æ´»ã‹ã—ã¦é‡è¦ãªèª²é¡Œã«å–ã‚Šçµ„ã‚€ã®ã«æœ€é©ã€‚",
      "money": "é•·æœŸçš„ãªæŠ•è³‡æˆ¦ç•¥ã‚’ç·´ã‚‹ã®ã«è‰¯ã„æ—¥ã€‚ã˜ã£ãã‚Šæ¤œè¨Žã‚’ã€‚",
      "luckyColor": "æ·±ç´…",
      "luckyNumber": 8
    }
  },
  "å°„æ‰‹åº§": {
    "dateRange": "11/23-12/21",
    "icon": "â™",
    "today": {
      "fortune": "å†’é™ºå¿ƒãŒåˆºæ¿€ã•ã‚Œã‚‹æ—¥ã€‚æ–°ã—ã„æŒ‘æˆ¦ã‚„å­¦ã³ã®æ©Ÿä¼šã‚’æ±‚ã‚ã¦ã€‚",
      "love": "è‡ªç”±ã§é–‹æ”¾çš„ãªé–¢ä¿‚ãŒå¿ƒåœ°ã‚ˆã„æ—¥ã€‚æŸç¸›ã‚ˆã‚Šã‚‚ä¿¡é ¼ã‚’ã€‚",
      "work": "æµ·å¤–ã‚„é æ–¹ã¨ã®é–¢ã‚ã‚Šã§è‰¯ã„å±•é–‹ãŒæœŸå¾…ã§ããã†ã€‚",
      "money": "å°†æ¥ã¸ã®æŠ•è³‡ã‚„å­¦ç¿’ã«ãŠé‡‘ã‚’ä½¿ã†ã®ãŒå‰ã€‚",
      "luckyColor": "ç´«",
      "luckyNumber": 9
    }
  },
  "å±±ç¾Šåº§": {
    "dateRange": "12/22-1/19",
    "icon": "â™‘",
    "today": {
      "fortune": "è²¬ä»»æ„Ÿã¨è¨ˆç”»æ€§ãŒæˆåŠŸã‚’ã‚‚ãŸã‚‰ã™æ—¥ã€‚ç€å®Ÿã«ç›®æ¨™ã«å‘ã‹ã£ã¦é€²ã‚“ã§ã€‚",
      "love": "çœŸé¢ç›®ã§èª å®Ÿãªå§¿å‹¢ãŒç›¸æ‰‹ã®å¿ƒã‚’å‹•ã‹ã—ã¾ã™ã€‚",
      "work": "é•·æœŸçš„ãªè¦–é‡Žã«ç«‹ã£ãŸå–ã‚Šçµ„ã¿ãŒè©•ä¾¡ã•ã‚Œã‚‹æ—¥ã€‚",
      "money": "å …å®Ÿãªè²¯è“„ã‚„è³‡ç”£å½¢æˆã«ã¤ã„ã¦æ¤œè¨Žã™ã‚‹ã®ã«æœ€é©ã€‚",
      "luckyColor": "èŒ¶è‰²",
      "luckyNumber": 10
    }
  },
  "æ°´ç“¶åº§": {
    "dateRange": "1/20-2/18",
    "icon": "â™’",
    "today": {
      "fortune": "ç‹¬å‰µæ€§ã¨é©æ–°çš„ãªã‚¢ã‚¤ãƒ‡ã‚¢ãŒå…‰ã‚‹æ—¥ã€‚å¾“æ¥ã®æž ã«ã¨ã‚‰ã‚ã‚Œãªã„ç™ºæƒ³ã‚’ã€‚",
      "love": "å‹æƒ…ã‹ã‚‰å§‹ã¾ã‚‹æ‹æ„›ã«ç™ºå±•ã®å¯èƒ½æ€§ã€‚è‡ªç„¶ä½“ã§ã„ã‚‹ã“ã¨ãŒå¤§åˆ‡ã€‚",
      "work": "ãƒ†ã‚¯ãƒŽãƒ­ã‚¸ãƒ¼ã‚„æ–°ã—ã„æ‰‹æ³•ã‚’å–ã‚Šå…¥ã‚Œã‚‹ã“ã¨ã§æˆæžœãŒä¸ŠãŒã‚Šãã†ã€‚",
      "money": "ä»®æƒ³é€šè²¨ã‚„æ–°ã—ã„æŠ•è³‡å•†å“ã«èˆˆå‘³ã‚’æŒã¤æ—¥ã€‚æƒ…å ±åŽé›†ã‚’ã€‚",
      "luckyColor": "æ°´è‰²",
      "luckyNumber": 11
    }
  },
  "é­šåº§": {
    "dateRange": "2/19-3/20",
    "icon": "â™“",
    "today": {
      "fortune": "ç›´æ„Ÿã¨æƒ³åƒåŠ›ãŒè±Šã‹ã«ãªã‚‹æ—¥ã€‚èŠ¸è¡“çš„ãªæ´»å‹•ã‚„å‰µä½œã«å‘ã„ã¦ã„ã¾ã™ã€‚",
      "love": "ãƒ­ãƒžãƒ³ãƒãƒƒã‚¯ãªé›°å›²æ°—ã‚’å¤§åˆ‡ã«ã€‚æ„Ÿæƒ…è¡¨ç¾ãŒç›¸æ‰‹ã«éŸ¿ãã¾ã™ã€‚",
      "work": "å…±æ„ŸåŠ›ã‚’æ´»ã‹ã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã‚„äººåŠ©ã‘ã§è©•ä¾¡ã‚’å¾—ã‚‰ã‚Œãã†ã€‚",
      "money": "è¡å‹•çš„ãªè²·ã„ç‰©ã¯æŽ§ãˆã¦ã€‚æ„Ÿæƒ…ã«æµã•ã‚Œãªã„åˆ¤æ–­ã‚’ã€‚",
      "luckyColor": "æµ·ã®é’",
      "luckyNumber": 12
    }
  }
};

// Color class mapping for lucky colors
const colorClassMap = {
  "èµ¤": "color-red",
  "ç·‘": "color-green", 
  "é»„è‰²": "color-yellow",
  "éŠ€": "color-silver",
  "é‡‘": "color-gold",
  "ç´º": "color-navy",
  "ãƒ”ãƒ³ã‚¯": "color-pink",
  "æ·±ç´…": "color-crimson",
  "ç´«": "color-purple",
  "èŒ¶è‰²": "color-brown",
  "æ°´è‰²": "color-lightblue",
  "æµ·ã®é’": "color-seablue"
};

// DOM elements
const birthDateInput = document.getElementById('birthDate');
const fortuneButton = document.getElementById('fortuneButton');
const resultSection = document.getElementById('resultSection');
const inputSection = document.getElementById('inputSection');
const tryAgainButton = document.getElementById('tryAgainButton');

// Result display elements
const zodiacIcon = document.getElementById('zodiacIcon');
const zodiacName = document.getElementById('zodiacName');
const zodiacPeriod = document.getElementById('zodiacPeriod');
const overallFortune = document.getElementById('overallFortune');
const loveFortune = document.getElementById('loveFortune');
const workFortune = document.getElementById('workFortune');
const moneyFortune = document.getElementById('moneyFortune');
const luckyColor = document.getElementById('luckyColor');
const luckyColorSwatch = document.getElementById('luckyColorSwatch');
const luckyNumber = document.getElementById('luckyNumber');

// Determine zodiac sign from birth date
function getZodiacSign(birthDate) {
  const date = new Date(birthDate);
  const month = date.getMonth() + 1; // getMonth() returns 0-11
  const day = date.getDate();
  
  // Zodiac date ranges
  const zodiacRanges = [
    { sign: "å±±ç¾Šåº§", start: [12, 22], end: [1, 19] },
    { sign: "æ°´ç“¶åº§", start: [1, 20], end: [2, 18] },
    { sign: "é­šåº§", start: [2, 19], end: [3, 20] },
    { sign: "ç‰¡ç¾Šåº§", start: [3, 21], end: [4, 19] },
    { sign: "ç‰¡ç‰›åº§", start: [4, 20], end: [5, 20] },
    { sign: "åŒå­åº§", start: [5, 21], end: [6, 21] },
    { sign: "èŸ¹åº§", start: [6, 22], end: [7, 22] },
    { sign: "ç…å­åº§", start: [7, 23], end: [8, 22] },
    { sign: "ä¹™å¥³åº§", start: [8, 23], end: [9, 22] },
    { sign: "å¤©ç§¤åº§", start: [9, 23], end: [10, 23] },
    { sign: "è åº§", start: [10, 24], end: [11, 22] },
    { sign: "å°„æ‰‹åº§", start: [11, 23], end: [12, 21] }
  ];

  for (const range of zodiacRanges) {
    const [startMonth, startDay] = range.start;
    const [endMonth, endDay] = range.end;
    
    if (startMonth === endMonth) {
      // Same month range
      if (month === startMonth && day >= startDay && day <= endDay) {
        return range.sign;
      }
    } else {
      // Cross-month range
      if ((month === startMonth && day >= startDay) || 
          (month === endMonth && day <= endDay)) {
        return range.sign;
      }
    }
  }
  
  return null;
}

// Display fortune results with animation
function displayFortune(sign) {
  const data = zodiacData[sign];
  
  // Populate the result elements
  zodiacIcon.textContent = data.icon;
  zodiacName.textContent = sign;
  zodiacPeriod.textContent = data.dateRange;
  overallFortune.textContent = data.today.fortune;
  loveFortune.textContent = data.today.love;
  workFortune.textContent = data.today.work;
  moneyFortune.textContent = data.today.money;
  luckyColor.textContent = data.today.luckyColor;
  luckyNumber.textContent = data.today.luckyNumber;
  
  // Set lucky color swatch
  const colorClass = colorClassMap[data.today.luckyColor];
  luckyColorSwatch.className = `color-swatch ${colorClass}`;
  
  // Hide input section and show results with animation
  setTimeout(() => {
    inputSection.style.opacity = '0';
    inputSection.style.transform = 'translateY(-20px)';
    inputSection.style.pointerEvents = 'none';
    
    setTimeout(() => {
      resultSection.classList.add('show');
    }, 300);
  }, 500);
}

// Reset to input view
function resetToInput() {
  resultSection.classList.remove('show');
  
  setTimeout(() => {
    inputSection.style.opacity = '1';
    inputSection.style.transform = 'translateY(0)';
    inputSection.style.pointerEvents = 'all';
    birthDateInput.value = '';
    
    // Remove loading state if present
    fortuneButton.classList.remove('loading');
    fortuneButton.textContent = 'ðŸ”® å ã†';
  }, 300);
}

// Handle fortune button click
function handleFortuneClick() {
  const birthDate = birthDateInput.value;
  
  if (!birthDate) {
    alert('ç”Ÿå¹´æœˆæ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
    return;
  }
  
  // Add loading animation
  fortuneButton.classList.add('loading');
  fortuneButton.textContent = '';
  
  // Simulate processing time for better UX
  setTimeout(() => {
    const zodiacSign = getZodiacSign(birthDate);
    
    if (zodiacSign) {
      displayFortune(zodiacSign);
    } else {
      alert('æ˜Ÿåº§ã®åˆ¤å®šã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ­£ã—ã„æ—¥ä»˜ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
      fortuneButton.classList.remove('loading');
      fortuneButton.textContent = 'ðŸ”® å ã†';
    }
  }, 1500);
}

// Event listeners
fortuneButton.addEventListener('click', handleFortuneClick);
tryAgainButton.addEventListener('click', resetToInput);

// Allow Enter key to trigger fortune
birthDateInput.addEventListener('keypress', (e) => {
  if (e.key === 'Enter') {
    handleFortuneClick();
  }
});

// Set max date to today
const today = new Date().toISOString().split('T')[0];
birthDateInput.setAttribute('max', today);

// Initialize app
document.addEventListener('DOMContentLoaded', () => {
  // Focus on birth date input
  birthDateInput.focus();
  
  // Add subtle entrance animation to input section
  setTimeout(() => {
    inputSection.style.animation = 'fadeInUp 0.8s ease-out';
  }, 200);
});